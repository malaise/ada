<?xml version="1.0"?>
<!DOCTYPE chats SYSTEM "chats.dtd">
<!-- Example of TCP chat script -->

<chats>
  <!-- HTTP 0.9: Send file -->
  <chat Name="httpTopic0.9"
        >GET http://localhost${HOME}/t_xml/Topic_Type\.dtd</chat>
  <script>
    <call>cat ${HOME}/t_xml/Topic_Type.dtd</call>
    <close/>
  </script>
  <!-- HTTP 1.0 or 1.1: Send header + file -->
  <chat Name="httpTopic1." TimeoutMs="1_000"
        >GET http://localhost${HOME}/t_xml/Topic_Type\.dtd HTTP/1\.(0|1)</chat>
  <script>
    <read></read>
    <send>HTTP/1.1 200 OK</send>
    <send>Date: Sat, 28 Aug 2010 07:04:35 GMT</send>
    <send>Server: Apache/ProXad [Aug  9 2008 02:45:09]</send>
    <send>Last-Modified: Mon, 23 Aug 2010 18:00:15 GMT</send>
    <send>ETag: "6f332b-125-4c72b72f"</send>
    <send>Connection: close</send>
    <send>Accept-Ranges: bytes</send>
    <send>Content-Length: 293</send>
    <send>Content-Type: application/xml-dtd</send>
    <send></send>
    <call>cat ${HOME}/t_xml/Topic_Type.dtd</call>
    <close/>
  </script>
  <!-- Tcping: Send pong and leav connected -->
  <chat Name="tcping" TimeoutMs="1_000">(tc)?ping</chat>
  <script>
    <send>pong</send>
  </script>
  <!-- TEST wait then close -->
  <chat Name="testWaitClose">close</chat>
  <script>
    <wait DelayMs="1000"/>
    <close/>
  </script>
  <!-- TEST simulate a ppp login chat -->
  <chat Name="testPpp">ppp</chat>
  <script>
    <send>AT</send>
    <read TimeoutMs="5_000">OK</read>
    <send>ATQ0 V1 E1 S0=0 &amp;C1 &amp;D2 +FCLASS=0</send>
    <read TimeoutMs="5_000">OK</read>
    <send>ATDT0860922000</send>
    <select TimeoutMs="60_000">
      <expect>BUSY|ERROR|NO CARRIER|VOICE|NO DIAL ?TONE|NO ANSWER|DELAYED</expect>
      <script>
        <close/>
      </script>
      <expect>CONNECT( [0-9]+)?</expect>
      <script>
        <read TimeoutMs="30_000">.ogin</read>
        <send>malaise</send>
        <read TimeoutMs="10_000">.{4}word</read>
        <send>${PASSWORD}</send>
        <send>Working: Please wait...</send>
        <wait DelayMs="5_000"/>
        <send>Done. Please logout.</send>
        <read TimeoutMs="10_000">logout</read>
        <close/>
      </script>
    </select>
  </script>
  <!-- TEST multiple select -->
  <chat Name="testMulti"
        InputDefaultTimeoutMs="None">testMulti</chat>
    <!-- A chat is like a expect, but with attibutes (Name...) -->
  <script>
    <send></send>
    <select>
      <expect>login</expect>
      <script>
        <send>me</send>
        <select>
          <expect>password</expect>
          <script>
            <send>pass</send>
          </script>
          <expect>PASSWORD</expect>
          <script>
            <send>PASS</send>
          </script>
          <default/>
          <script>
            <close/>
          </script>
        </select>
        <wait DelayMs="10"/>
        <send>ls</send>
      </script>
      <expect>LOGIN</expect>
      <script>
        <send>ME</send>
        <read>PASSWORD</read>
        <send>PASS</send>
      </script>
    </select>
    <wait DelayMs="1_000"/>
    <close/>
  </script>
</chats>

