<?xml version="1.0"?>
<!DOCTYPE chats SYSTEM "chats.dtd">
<!-- TCP chat script for handling rsh -->

<chats>
  <version Version="&Version;"/>

  <!-- Empty: discard -->
  <chat Name="empty"></chat>
  <script>
  </script>

  <!-- cd: change dir -->
  <chat Name="chdir" Regexp="true" Assign="TARGET=${2}">cd( +(.*))?</chat>
  <script>
    <set Variable="OK">true</set>
    <chdir>
      <dir>${TARGET}</dir>
      <error/>
      <script>
        <set Variable="OK">false</set>
        <send>ERROR changing dir to ${TARGET}</send>
      </script>
    </chdir>
    <cond>
      <if Variable="OK">true</if>
      <script>
        <eval Variable="PWD">
          <command>pwd</command>
        </eval>
        <send NewLine="false">${PWD}</send>
      </script>
    </cond>
  </script>

  <!-- exit: close -->
  <chat Name="close">exit</chat>
  <script>
    <close/>
  </script>

  <!-- Other: execude command -->
  <chat Name="rsh" Regexp="true" Assign="COMMAND=${0}">.*</chat>
  <script>
    <call>
      <command>${COMMAND}</command>
      <error/>
      <script>
        <send>ERROR executing command ${COMMAND}</send>
      </script>
    </call>
  </script>

</chats>

